<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è¬ç”¨ä½œæ–‡æ¨¡æ¿</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-7BDSKB7YSY');
    </script>

    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; -webkit-tap-highlight-color: transparent; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* å‹•ç•«æ•ˆæœ */
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .animate-slide-up { animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }
    </style>
</head>
<body class="bg-[#F7F7F5] text-[#37352F] h-[100dvh] overflow-hidden">
    <div id="root" class="h-full"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS (SVG) ---
        const Icons = {
            Book: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>,
            FileText: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>,
            Play: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>,
            Pause: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>,
            Square: () => <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/></svg>,
            Eye: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>,
            X: () => <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>,
            ToggleLeft: () => <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#9CA3AF" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="1" y="5" width="22" height="14" rx="7" ry="7"/><circle cx="8" cy="12" r="3"/></svg>,
            ToggleRight: () => <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#EB5757" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="1" y="5" width="22" height="14" rx="7" ry="7"/><circle cx="16" cy="12" r="3"/></svg>,
            Translate: () => <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 8l6 6"/><path d="M4 14h6"/><path d="M2 5h12"/><path d="M7 2v3"/><path d="M22 22l-5-10-5 10"/><path d="M14 18h6"/></svg>,
            ChevronDown: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9l6 6 6-6"/></svg>,
            ChevronUp: () => <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 15l-6-6-6 6"/></svg>
        };

        // --- è³‡æ–™åº« ---
        const VOCAB_DB = {
            "prevalence": { kk: "[Ë‹prÉ›vÉ™lÉ™ns]", pos: "n.", def: "æµè¡Œï¼›æ™®åŠ", ex: "The prevalence of smartphones is undeniable." },
            "indispensable": { kk: "[ÍµÉªndÉªsË‹pÉ›nsÉ™b!]", pos: "adj.", def: "ä¸å¯æˆ–ç¼ºçš„", ex: "Water is indispensable to life." },
            "contemplation": { kk: "[ÍµkÉ‘ntÉ›mË‹pleÊƒÉ™n]", pos: "n.", def: "æ²‰æ€ï¼›å‡è¦–", ex: "He sat in quiet contemplation of the view." },
            "evoke": { kk: "[ÉªË‹vok]", pos: "v.", def: "å–šèµ·ï¼›å¼•èµ·", ex: "The music evoked memories of her youth." },
            "lens": { kk: "[lÉ›nz]", pos: "n.", def: "é¡é ­ï¼›è¦–è§’", ex: "Try to look at the problem through a different lens." },
            "evident": { kk: "[Ë‹É›vÉ™dÉ™nt]", pos: "adj.", def: "æ˜é¡¯çš„", ex: "It is evident that you are tired." },
            "symbol": { kk: "[Ë‹sÉªmb!]", pos: "n.", def: "è±¡å¾µ", ex: "The dove is a symbol of peace." },
            "unparalleled": { kk: "[ÊŒnË‹pÃ¦rÉ™ÍµlÉ›ld]", pos: "adj.", def: "ç„¡æ¯”çš„ï¼›ç©ºå‰çš„", ex: "This athlete has unparalleled skill." },
            "customization": { kk: "[ÍµkÊŒstÉ™mÉªË‹zeÊƒÉ™n]", pos: "n.", def: "å®¢è£½åŒ–", ex: "The software offers high customization." },
            "tailor": { kk: "[Ë‹telÉš]", pos: "v.", def: "é‡èº«è¨‚åšï¼›èª¿æ•´", ex: "We can tailor the program to your needs." },
            "superficial": { kk: "[ÍµsupÉšË‹fÉªÊƒÉ™l]", pos: "adj.", def: "è¡¨é¢çš„ï¼›è†šæ·ºçš„", ex: "His injury was only superficial." },
            "phenomenon": { kk: "[fÉ™Ë‹nÉ‘mÉ™ÍµnÉ‘n]", pos: "n.", def: "ç¾è±¡", ex: "Snow in July is a rare phenomenon." },
            "implications": { kk: "[ÍµÉªmplÉªË‹keÊƒÉ™nz]", pos: "n.", def: "å½±éŸ¿ï¼›æš—ç¤º", ex: "We must consider the long-term implications." },
            "wary": { kk: "[Ë‹wÉ›rÉª]", pos: "adj.", def: "è¬¹æ…çš„ï¼›æé˜²çš„", ex: "Be wary of strangers offering gifts." },
            "excessive": { kk: "[ÉªkË‹sÉ›sÉªv]", pos: "adj.", def: "éåº¦çš„", ex: "Excessive noise can damage hearing." },
            "indulgence": { kk: "[ÉªnË‹dÊŒldÊ’É™ns]", pos: "n.", def: "æ”¾ç¸±ï¼›æ²ˆæºº", ex: "Chocolate is my only indulgence." },
            "culinary": { kk: "[Ë‹kÊŒlÉªÍµnÉ›rÉª]", pos: "adj.", def: "çƒ¹é£ªçš„", ex: "She is studying culinary arts." },
            "vibrancy": { kk: "[Ë‹vaÉªbrÉ™nsÉª]", pos: "n.", def: "æ´»åŠ›ï¼›ç”Ÿæ°£", ex: "The vibrancy of the city is exciting." },
            "propagates": { kk: "[Ë‹prÉ‘pÉ™Íµgets]", pos: "v.", def: "å‚³æ’­ï¼›ç¹æ®–", ex: "Rumors propagate quickly online." },
            "vulnerability": { kk: "[ÍµvÊŒlnÉ™rÉ™Ë‹bÉªlÉ™tÉª]", pos: "n.", def: "è„†å¼±æ€§", ex: "He admitted his vulnerability." },
            "imminent": { kk: "[Ë‹ÉªmÉ™nÉ™nt]", pos: "adj.", def: "å³å°‡ç™¼ç”Ÿçš„", ex: "A storm is imminent." },
            "hypothetical": { kk: "[ÍµhaÉªpÉ™Ë‹Î¸É›tÉªk!]", pos: "adj.", def: "å‡è¨­çš„", ex: "This is a hypothetical situation." },
            "garner": { kk: "[Ë‹gÉ‘rnÉš]", pos: "v.", def: "ç²å¾—ï¼›æ”¶é›†", ex: "The movie garnered rave reviews." },
            "contend": { kk: "[kÉ™nË‹tÉ›nd]", pos: "v.", def: "ä¸»å¼µï¼›ç«¶çˆ­", ex: "I contend that this is the best option." },
            "imperative": { kk: "[ÉªmË‹pÉ›rÉ™tÉªv]", pos: "adj.", def: "å¿…è¦çš„ï¼›æ¥µé‡è¦çš„", ex: "It is imperative to act now." },
            "catalyst": { kk: "[Ë‹kÃ¦tÉ™lÉªst]", pos: "n.", def: "å‚¬åŒ–åŠ‘ï¼›æ¨æ‰‹", ex: "The protest was a catalyst for change." },
            "recur": { kk: "[rÉªË‹kÉ]", pos: "v.", def: "é‡ç¾ï¼›å¾©ç™¼", ex: "The problem tends to recur." },
            "emergence": { kk: "[ÉªË‹mÉdÊ’É™ns]", pos: "n.", def: "å‡ºç¾ï¼›æµ®ç¾", ex: "The emergence of AI changed everything." },
            "superstition": { kk: "[ÍµsupÉšË‹stÉªÊƒÉ™n]", pos: "n.", def: "è¿·ä¿¡", ex: "It is a superstition to avoid black cats." },
            "suspicion": { kk: "[sÉ™Ë‹spÉªÊƒÉ™n]", pos: "n.", def: "æ‡·ç–‘", ex: "I have a suspicion that he is lying." },
            "desperate": { kk: "[Ë‹dÉ›spÉ™rÉªt]", pos: "adj.", def: "çµ•æœ›çš„ï¼›æ¥µåº¦æ¸´æœ›çš„", ex: "They made a desperate attempt to escape." },
            "mortality": { kk: "[mÉ”rË‹tÃ¦lÉ™tÉª]", pos: "n.", def: "å¿…æ­»æ€§ï¼›æ­»äº¡ç‡", ex: "Humans are aware of their mortality." },
            "cherish": { kk: "[Ë‹tÊƒÉ›rÉªÊƒ]", pos: "v.", def: "çæƒœ", ex: "I cherish our time together." },
            "authentic": { kk: "[É”Ë‹Î¸É›ntÉªk]", pos: "adj.", def: "é“åœ°çš„ï¼›çœŸå¯¦çš„", ex: "This is authentic Italian food." },
            "convinced": { kk: "[kÉ™nË‹vÉªnst]", pos: "adj.", def: "ç¢ºä¿¡çš„", ex: "I am convinced of his innocence." },
            "inevitably": { kk: "[ÉªnË‹É›vÉ™tÉ™blÉª]", pos: "adv.", def: "ä¸å¯é¿å…åœ°", ex: "Inevitably, it started to rain." },
            "threat": { kk: "[Î¸rÉ›t]", pos: "n.", def: "å¨è„…", ex: "Pollution poses a threat to nature." },
            "perspective": { kk: "[pÉšË‹spÉ›ktÉªv]", pos: "n.", def: "è§€é»", ex: "From my perspective, it looks fine." },
            "allure": { kk: "[É™Ë‹ljÊŠr]", pos: "n.", def: "é­…åŠ›ï¼›èª˜æƒ‘", ex: "The allure of the city is strong." },
            "inclusivity": { kk: "[ÍµÉªnkluË‹sÉªvÉ™tÉª]", pos: "n.", def: "åŒ…å®¹æ€§", ex: "We promote inclusivity in the workplace." },
            "dynamic": { kk: "[daÉªË‹nÃ¦mÉªk]", pos: "adj.", def: "å‹•æ…‹çš„ï¼›å……æ»¿æ´»åŠ›çš„", ex: "The market is very dynamic." },
            "unflagging": { kk: "[ÊŒnË‹flÃ¦gÉªÅ‹]", pos: "adj.", def: "ä¸æ‡ˆçš„", ex: "Her unflagging support helped me." },
            "experiential": { kk: "[ÉªkÍµspÉªrÉªË‹É›nÊƒÉ™l]", pos: "adj.", def: "ç¶“é©—çš„ï¼›é«”é©—å¼çš„", ex: "The museum offers experiential learning." }
        };

        const FOOTNOTE_DB = {
            1: ["the prevalence of smartphone usage", "the fascinating culture of queuing", "the looming shadow of doomsday predictions"],
            2: ["people are glued to screens", "crowds flock to new restaurants"],
            3: ["my own habits", "the predicted disaster"],
            4: ["the warmth of human kindness and the convenient, sleepless vibrancy of our night markets", "how easily fear spreads, affecting even tourism and daily decisions"],
            5: ["our anxiety", "our digital dependence", "the vibrancy of Taiwanese society"],
            6: ["my health", "how we should live", "marketing Taiwan"],
            7: ["the pros and cons", "the possibility of the end of the world"],
            8: ["while they are probably not scientifically accurate, they are a valuable philosophical reminder of our mortality"],
            9: ["mitigate health risks", "promote our culture", "spend my final days"],
            10: ["launch social media campaigns that invite influencers to 'live a day as a local,' immersing them in the authentic warmth and culinary delights we offer"],
            11: ["this cultural promotion", "this doomsday scenario"],
            12: ["prioritize our time", "cherish our identity"]
        };

        const FORMULA_PARAGRAPHS = [
            `[P1]
In the context of modern existence, few subjects evoke as much contemplation as æè¿°ä¸»é¡Œçš„åè©[1]. Whether viewed through the lens of social trends or personal experience, it is evident that æ˜ç¢ºç´°ç¯€çš„å¥å­[2]. Specifically, regarding æ˜ç¢ºçš„ç´°ç¯€åè©[3], one cannot help but notice æè¿°ç´°ç¯€çš„åè©[4]. This phenomenon is not merely superficial; it serves as a mirror reflecting æ·±åˆ»çš„æ„ç¾©(åè©)[5].`,
            
            `[P2]
While the aforementioned observations provide the context, a deeper reflection reveals significant implications regarding æ ¸å¿ƒå•é¡Œ(åè©)[6]. If I were to evaluate å•é¡Œ/å„ªç¼ºé»/å¯èƒ½æ€§ç­‰(åè©)[7], I would contend that è‡ªå·±çš„é¸æ“‡æˆ–ç«‹å ´(å¥å­)[8]. Consequently, to ç›®çš„(åŸå½¢å‹•è©)[9], my approach would be to æ‰“ç®—åšçš„è¡Œå‹•(åŸå½¢å‹•è©)[10]. Ultimately, ä¸»é¡Œ(å•é¡Œã€ç¾è±¡)åè©[11] acts as a catalyst, compelling us to rethink how we çµè«–(å‹•è©)[12].`
        ];

        const ESSAYS_DATA = [
            {
                id: 1,
                title: "ç¯„æ–‡ 1: Hand-shaken Drinks",
                prompt: "æç¤ºï¼šç¾ä»£è‡ºç£äººæˆ–å¤šæˆ–å°‘éƒ½æœƒè²·æ‰‹æ–é£²ä¾†å–,æ™®éèªç‚ºæ‰‹æ–é£²å¾ˆæ–¹ä¾¿ä¸”èƒ½å®¢è£½åŒ–,æ•…æˆç‚ºè¨±å¤šäººæ—¥å¸¸ç”Ÿæ´»çš„ä¸€éƒ¨åˆ†ã€‚è«‹ä»¥æ­¤ç‚ºé¡Œ,å¯«ä¸€ç¯‡è‹±æ–‡ä½œæ–‡ã€‚ç¬¬ä¸€æ®µè«‹èªªæ˜æ‰‹æ–é£²åœ¨è‡ºç£æµè¡Œçš„åŸå› ,ç¬¬äºŒæ®µè«‹æ•˜è¿°ä½ è‡ªå·±æˆ–è¦ªå‹å°æ‰‹æ–é£²çš„çœ‹æ³•ã€‚",
                content: "In the context of modern existence, few subjects evoke as much contemplation as the prevalence of hand-shaken drinks in Taiwan. Whether viewed through the lens of Taiwanese food culture or daily habit, it is evident that carrying a cup of bubble tea has become a symbol of local life. Specifically, regarding the reasons behind their immense popularity, one cannot help but notice the unparalleled convenience and the high degree of customization available, allowing consumers to tailor sweetness levels and toppings to their exact preferences. This phenomenon is not merely superficial; it serves as a mirror reflecting the Taiwanese pursuit of 'tiny happiness' and the desire for personalized comfort amidst a fast-paced lifestyle.\n\nWhile the aforementioned observations provide the context, a deeper reflection reveals significant implications regarding the balance between psychological satisfaction and physical well-being. If I were to evaluate my family's perspective on these beverages, I would contend that while we acknowledge them as a delightful treat that relieves stress, we remain wary of the potential health risks associated with excessive sugar intake. Consequently, to enjoy these drinks without compromising our health, my approach would be to treat them as an occasional indulgence rather than a daily necessity, and to opt for sugar-free tea or fresh fruit alternatives. Ultimately, the hand-shaken drink culture acts as a catalyst, compelling us to rethink how we make conscious dietary choices in an environment filled with temptation.",
                translation: "åœ¨ç¾ä»£ç”Ÿå­˜çš„èƒŒæ™¯ä¸‹ï¼Œå¾ˆå°‘æœ‰ä¸»é¡Œèƒ½åƒå°ç£æ‰‹æ–é£²æ–™çš„æ™®åŠé‚£æ¨£å¼•èµ·å¦‚æ­¤å¤šçš„æ²‰æ€ã€‚ç„¡è«–æ˜¯é€éå°ç£é£²é£Ÿæ–‡åŒ–é‚„æ˜¯æ—¥å¸¸ç¿’æ…£çš„è¦–è§’ä¾†çœ‹ï¼Œå¾ˆæ˜é¡¯åœ°ï¼Œæ‹¿è‘—ä¸€æ¯çç å¥¶èŒ¶å·²ç¶“æˆç‚ºåœ¨åœ°ç”Ÿæ´»çš„è±¡å¾µã€‚å…·é«”ä¾†èªªï¼Œé—œæ–¼å…¶æ¥µåº¦å—æ­¡è¿çš„åŸå› ï¼Œäººå€‘ä¸å¾—ä¸æ³¨æ„åˆ°å…¶ç„¡èˆ‡å€«æ¯”çš„ä¾¿åˆ©æ€§å’Œé«˜åº¦çš„å®¢è£½åŒ–ï¼Œè®“æ¶ˆè²»è€…èƒ½å¤ æ ¹æ“šè‡ªå·±çš„ç¢ºåˆ‡å–œå¥½èª¿æ•´ç”œåº¦å’Œé…æ–™ã€‚é€™ç¨®ç¾è±¡ä¸åƒ…åƒ…æ˜¯è¡¨é¢çš„ï¼›å®ƒå°±åƒä¸€é¢é¡å­ï¼Œåæ˜ äº†å°ç£äººå°ã€Œå°ç¢ºå¹¸ã€çš„è¿½æ±‚ï¼Œä»¥åŠåœ¨å¿«ç¯€å¥çš„ç”Ÿæ´»æ–¹å¼ä¸­å°å€‹äººåŒ–æ…°è—‰çš„æ¸´æœ›ã€‚\n\né›–ç„¶ä¸Šè¿°è§€å¯Ÿæä¾›äº†èƒŒæ™¯ï¼Œä½†æ›´æ·±å…¥çš„åæ€æ­ç¤ºäº†é—œæ–¼å¿ƒç†æ»¿è¶³èˆ‡èº«é«”å¥åº·ä¹‹é–“å¹³è¡¡çš„é‡å¤§å½±éŸ¿ã€‚å¦‚æœè¦è©•ä¼°æˆ‘å€‘å®¶å°é€™äº›é£²æ–™çš„çœ‹æ³•ï¼Œæˆ‘æœƒä¸»å¼µé›–ç„¶æˆ‘å€‘æ‰¿èªå®ƒå€‘æ˜¯ç·©è§£å£“åŠ›çš„æ„‰å¿«äº«å—ï¼Œä½†æˆ‘å€‘ä»ç„¶å°èˆ‡æ”å…¥éå¤šç³–åˆ†ç›¸é—œçš„æ½›åœ¨å¥åº·é¢¨éšªä¿æŒè­¦æƒ•ã€‚å› æ­¤ï¼Œç‚ºäº†åœ¨ä¸æå®³å¥åº·çš„æƒ…æ³ä¸‹äº«å—é€™äº›é£²æ–™ï¼Œæˆ‘çš„åšæ³•æ˜¯å°‡å®ƒå€‘è¦–ç‚ºå¶çˆ¾çš„æ”¾ç¸±ï¼Œè€Œä¸æ˜¯æ—¥å¸¸å¿…éœ€å“ï¼Œä¸¦é¸æ“‡ç„¡ç³–èŒ¶æˆ–æ–°é®®æ°´æœæ›¿ä»£å“ã€‚æœ€çµ‚ï¼Œæ‰‹æ–é£²æ–™æ–‡åŒ–å……ç•¶äº†å‚¬åŒ–åŠ‘ï¼Œè¿«ä½¿æˆ‘å€‘é‡æ–°æ€è€ƒå¦‚ä½•åœ¨å……æ»¿èª˜æƒ‘çš„ç’°å¢ƒä¸­åšå‡ºæœ‰æ„è­˜çš„é£²é£Ÿé¸æ“‡ã€‚"
            },
            {
                id: 2,
                title: "ç¯„æ–‡ 2: Pride of Taiwan",
                prompt: "æç¤ºï¼šèº«ç‚ºè‡ºç£çš„ä¸€ä»½å­ï¼Œè‡ºç£æœ€è®“ä½ æ„Ÿåˆ°é©•å‚²çš„æ˜¯ä»€éº¼ï¼Ÿè«‹ä»¥æ­¤ç‚ºé¡Œï¼Œå¯«ä¸€ç¯‡è‹±æ–‡ä½œæ–‡ï¼Œè«‡è‡ºç£æœ€è®“ä½ å¼•ä»¥ç‚ºæ¦®çš„äºŒå€‹é¢å‘æˆ–äº‹ç‰©ï¼ˆä¾‹å¦‚ï¼šäººã€äº‹ã€ç‰©ã€æ–‡åŒ–ã€åˆ¶åº¦ç­‰ï¼‰ã€‚ç¬¬ä¸€æ®µæè¿°é€™äºŒå€‹é¢å‘æˆ–äº‹ç‰©ï¼Œä¸¦èªªæ˜å®ƒå€‘ç‚ºä½•è®“ä½ å¼•ä»¥ç‚ºæ¦®ï¼›ç¬¬äºŒæ®µå‰‡èªªæ˜ä½ èªç‚ºå¯ä»¥ç”¨ä»€éº¼æ–¹å¼ä¾†ä»‹ç´¹æˆ–è¡ŒéŠ·é€™äº›è‡ºç£ç‰¹è‰²ï¼Œè®“ä¸–äººæ›´äº†è§£è‡ºç£ã€‚",
                content: "In the context of modern existence, few subjects evoke as much contemplation as the unique charm of my homeland, Taiwan. Whether viewed through the lens of a local resident or an international traveler, it is evident that this island possesses a distinct allure that captivates the soul. Specifically, regarding what makes me proudest, one cannot help but notice the warmth of human kindness and the convenient, sleepless vibrancy of our night markets. This phenomenon is not merely superficial; it serves as a mirror reflecting Taiwan's spirit of inclusivity and its dynamic, unflagging energy.\n\nWhile the aforementioned observations provide the context, a deeper reflection reveals significant implications regarding how we can project this soft power to the global stage. If I were to evaluate the best strategy to introduce these features, I would contend that experiential storytelling is far more powerful than mere slogans. Consequently, to market Taiwan to the world, my approach would be to launch social media campaigns that invite influencers to 'live a day as a local,' immersing them in the authentic warmth and culinary delights we offer. Ultimately, this cultural promotion acts as a catalyst, compelling us to rethink how we define our identity and share our treasures with the global community.",
                translation: "åœ¨ç¾ä»£ç”Ÿå­˜çš„èƒŒæ™¯ä¸‹ï¼Œå¾ˆå°‘æœ‰ä¸»é¡Œèƒ½åƒæˆ‘å®¶é„‰â€”â€”å°ç£â€”â€”çš„ç¨ç‰¹é­…åŠ›é‚£æ¨£å¼•èµ·å¦‚æ­¤å¤šçš„æ²‰æ€ã€‚ç„¡è«–æ˜¯é€éç•¶åœ°å±…æ°‘é‚„æ˜¯åœ‹éš›æ—…å®¢çš„è¦–è§’ä¾†çœ‹ï¼Œå¾ˆæ˜é¡¯åœ°ï¼Œé€™åº§å³¶å¶¼æ“æœ‰ç¨ç‰¹çš„å¸å¼•åŠ›ï¼Œèƒ½è¿·ä½éˆé­‚ã€‚å…·é«”ä¾†èªªï¼Œé—œæ–¼è®“æˆ‘æœ€æ„Ÿé©•å‚²çš„äº‹ç‰©ï¼Œäººå€‘ä¸å¾—ä¸æ³¨æ„åˆ°æ¿ƒåšçš„äººæƒ…å‘³ä»¥åŠä¾¿åˆ©ã€ä¸å¤œåŸçš„å¤œå¸‚æ´»åŠ›ã€‚é€™ç¨®ç¾è±¡ä¸åƒ…åƒ…æ˜¯è¡¨é¢çš„ï¼›å®ƒå°±åƒä¸€é¢é¡å­ï¼Œåæ˜ äº†å°ç£çš„åŒ…å®¹ç²¾ç¥åŠå…¶å……æ»¿æ´»åŠ›ã€ä¸æ‡ˆçš„èƒ½é‡ã€‚\n\né›–ç„¶ä¸Šè¿°è§€å¯Ÿæä¾›äº†èƒŒæ™¯ï¼Œä½†æ›´æ·±å…¥çš„åæ€æ­ç¤ºäº†é—œæ–¼æˆ‘å€‘å¦‚ä½•å°‡é€™ç¨®è»Ÿå¯¦åŠ›æŠ•å°„åˆ°å…¨çƒèˆå°çš„é‡å¤§å½±éŸ¿ã€‚å¦‚æœè¦è©•ä¼°ä»‹ç´¹é€™äº›ç‰¹è‰²çš„æœ€ä½³ç­–ç•¥ï¼Œæˆ‘æœƒä¸»å¼µé«”é©—å¼çš„æ•…äº‹è¬›è¿°é æ¯”å–®ç´”çš„å£è™Ÿå¼·å¤§å¾—å¤šã€‚å› æ­¤ï¼Œç‚ºäº†å‘ä¸–ç•Œè¡ŒéŠ·å°ç£ï¼Œæˆ‘çš„åšæ³•æ˜¯ç™¼èµ·ç¤¾ç¾¤åª’é«”æ´»å‹•ï¼Œé‚€è«‹ç¶²ç´…ã€Œåƒç•¶åœ°äººä¸€æ¨£ç”Ÿæ´»ä¸€å¤©ã€ï¼Œè®“ä»–å€‘æ²‰æµ¸åœ¨æˆ‘å€‘æä¾›çš„çœŸå¯¦æº«æš–å’Œç¾é£Ÿä½³é¤šä¸­ã€‚æœ€çµ‚ï¼Œé€™ç¨®æ–‡åŒ–æ¨å»£å……ç•¶äº†å‚¬åŒ–åŠ‘ï¼Œè¿«ä½¿æˆ‘å€‘é‡æ–°æ€è€ƒå¦‚ä½•å®šç¾©æˆ‘å€‘çš„èº«ä»½ä¸¦èˆ‡å…¨çƒç¤¾ç¾¤åˆ†äº«æˆ‘å€‘çš„çå¯¶ã€‚"
            },
            {
                id: 3,
                title: "ç¯„æ–‡ 3: Doomsday Prediction",
                prompt: "æç¤ºï¼šæ¯éš”ä¸€é™£å­ç¸½æœƒå‡ºç¾æœ«æ—¥é è¨€(doomsday prediction),å¦‚æ—¥æœ¬æœ‰ä½æ¼«ç•«å®¶é è¨€ 2025 å¹´ 7 æœˆ 5 æ—¥æœƒç™¼ç”Ÿå¼·éœ‡é‡å‰µæ—¥æœ¬å’Œé„°è¿‘åœ‹å®¶,æ­¤é è¨€å¼•ç™¼ææ…Œ,ç”šè‡³å½±éŸ¿å„åœ‹éŠå®¢åœ¨è©²æœˆåˆ°æ—¥æœ¬æ—…éŠçš„æ„é¡˜ã€‚ä½ ç›¸ä¿¡é€™ç¨®æœ«æ—¥é è¨€å—?è«‹å¯«ä¸€ç¯‡è‹±æ–‡ä½œæ–‡,æ–‡åˆ†å…©æ®µ,ç¬¬ä¸€æ®µé™³è¿°ä½ å°æœ«æ—¥é è¨€çš„çœ‹æ³•(æ˜¯è¿·ä¿¡é‚„æ˜¯å€¼å¾—åƒè€ƒ), ç¬¬äºŒæ®µèªªæ˜è‹¥ä¸–ç•Œæœ«æ—¥çœŸçš„åˆ°ä¾†,ä½ æœƒå¦‚ä½•åº¦éã€‚",
                content: "In the context of modern existence, few subjects evoke as much contemplation as the recurring emergence of doomsday predictions. Whether viewed through the lens of superstition or scientific caution, it is evident that such predictions often trigger a mix of panic and suspicion among the public. Specifically, regarding the prediction of a massive earthquake in July 2025, one cannot help but notice how easily fear propagates, affecting even tourism and daily decisions. This phenomenon is not merely superficial; it serves as a mirror reflecting humanity's inherent vulnerability and our desperate need for certainty in an unpredictable world.\n\nWhile the aforementioned observations provide the context, a deeper reflection reveals significant implications regarding how we perceive the value of our limited time. If I were to evaluate the credibility of these prophecies, I would contend that while they are probably not scientifically accurate, they are a valuable philosophical reminder of our mortality. Consequently, if the end of the world were truly imminent, my approach would not be to give in to despair, but to spend my final moments embracing my loved ones and expressing gratitude for the life I have lived. Ultimately, this doomsday scenario acts as a catalyst, compelling us to rethink how we cherish every present moment rather than fearing a hypothetical future.",
                translation: "åœ¨ç¾ä»£ç”Ÿå­˜çš„èƒŒæ™¯ä¸‹ï¼Œå¾ˆå°‘æœ‰ä¸»é¡Œèƒ½åƒåè¦†å‡ºç¾çš„æœ«æ—¥é è¨€é‚£æ¨£å¼•èµ·å¦‚æ­¤å¤šçš„æ²‰æ€ã€‚ç„¡è«–æ˜¯é€éè¿·ä¿¡é‚„æ˜¯ç§‘å­¸è¬¹æ…çš„è¦–è§’ä¾†çœ‹ï¼Œå¾ˆæ˜é¡¯åœ°ï¼Œé€™é¡é è¨€å¾€å¾€åœ¨å…¬çœ¾ä¸­å¼•ç™¼ææ…Œèˆ‡çŒœç–‘çš„æ··åˆæƒ…ç·’ã€‚å…·é«”ä¾†èªªï¼Œé—œæ–¼ 2025 å¹´ 7 æœˆç™¼ç”Ÿå¤§åœ°éœ‡çš„é è¨€ï¼Œäººå€‘ä¸å¾—ä¸æ³¨æ„åˆ°ææ‡¼æ˜¯å¤šéº¼å®¹æ˜“å‚³æ’­ï¼Œç”šè‡³å½±éŸ¿æ—…éŠå’Œæ—¥å¸¸æ±ºç­–ã€‚é€™ç¨®ç¾è±¡ä¸åƒ…åƒ…æ˜¯è¡¨é¢çš„ï¼›å®ƒå°±åƒä¸€é¢é¡å­ï¼Œåæ˜ äº†äººé¡å›ºæœ‰çš„è„†å¼±æ€§ä»¥åŠæˆ‘å€‘åœ¨ä¸å¯é æ¸¬çš„ä¸–ç•Œä¸­å°ç¢ºå®šæ€§çš„è¿«åˆ‡éœ€æ±‚ã€‚\n\né›–ç„¶ä¸Šè¿°è§€å¯Ÿæä¾›äº†èƒŒæ™¯ï¼Œä½†æ›´æ·±å…¥çš„åæ€æ­ç¤ºäº†é—œæ–¼æˆ‘å€‘å¦‚ä½•çœ‹å¾…æœ‰é™æ™‚é–“åƒ¹å€¼çš„é‡å¤§å½±éŸ¿ã€‚å¦‚æœè¦è©•ä¼°é€™äº›é è¨€çš„å¯ä¿¡åº¦ï¼Œæˆ‘æœƒä¸»å¼µé›–ç„¶å®ƒå€‘åœ¨ç§‘å­¸ä¸Šå¯èƒ½ä¸æº–ç¢ºï¼Œä½†å®ƒå€‘æ˜¯é—œæ–¼æˆ‘å€‘å¿…æ­»æ€§çš„å¯¶è²´å“²å­¸æé†’ã€‚å› æ­¤ï¼Œå¦‚æœä¸–ç•Œæœ«æ—¥çœŸçš„è¿«åœ¨çœ‰ç«ï¼Œæˆ‘çš„åšæ³•ä¸æ˜¯å±ˆæœæ–¼çµ•æœ›ï¼Œè€Œæ˜¯èŠ±æœ€å¾Œçš„æ™‚åˆ»æ“æŠ±æˆ‘çš„æ‘¯æ„›ï¼Œä¸¦å°æˆ‘æ‰€éçš„ç”Ÿæ´»è¡¨é”æ„Ÿæ¿€ã€‚æœ€çµ‚ï¼Œé€™å€‹æœ«æ—¥æƒ…å¢ƒå……ç•¶äº†å‚¬åŒ–åŠ‘ï¼Œè¿«ä½¿æˆ‘å€‘é‡æ–°æ€è€ƒå¦‚ä½•çæƒœç•¶ä¸‹çš„æ¯ä¸€åˆ»ï¼Œè€Œä¸æ˜¯ææ‡¼å‡è¨­çš„æœªä¾†ã€‚"
            }
        ];

        // --- æ ¸å¿ƒå…ƒä»¶ ---

        const useAudioPlayer = (text) => {
            const [state, setState] = useState('idle'); 
            const audioRef = useRef(null);
            const synthRef = useRef(window.speechSynthesis);

            const stop = () => {
                if (audioRef.current) { audioRef.current.pause(); audioRef.current.currentTime = 0; }
                if (synthRef.current.speaking || synthRef.current.paused) { synthRef.current.cancel(); }
                setState('idle');
            };

            const play = async () => {
                stop();
                setState('playing');
                try {
                    // ç°¡å–®æ¸…ç†æ–‡å­—ï¼Œè®“æœ—è®€æ›´é †æš¢ (ç§»é™¤ [P1], [1] ç­‰æ¨™è¨˜)
                    const cleanText = text.replace(/\[P\d+\]/g, '').replace(/\[\d+\]/g, '');
                    const encoded = encodeURIComponent(cleanText);
                    const url = `https://translate.google.com/translate_tts?ie=UTF-8&client=tw-ob&tl=en&q=${encoded}`;
                    const audio = new Audio(url);
                    audioRef.current = audio;
                    audio.onended = () => setState('idle');
                    audio.onerror = () => playFallback(cleanText);
                    await audio.play();
                } catch (e) {
                    // Fallback will use the cleaned text
                    playFallback(text.replace(/\[P\d+\]/g, '').replace(/\[\d+\]/g, ''));
                }
            };

            const playFallback = (cleanText) => {
                const u = new SpeechSynthesisUtterance(cleanText);
                u.lang = 'en-US'; u.rate = 0.9;
                u.onend = () => setState('idle');
                synthRef.current.speak(u);
            };

            const pause = () => {
                if (audioRef.current && !audioRef.current.paused) { audioRef.current.pause(); setState('paused'); }
                else if (synthRef.current.speaking) { synthRef.current.pause(); setState('paused'); }
            };

            const resume = () => {
                 if (audioRef.current && audioRef.current.paused) { audioRef.current.play(); setState('playing'); }
                else if (synthRef.current.paused) { synthRef.current.resume(); setState('playing'); }
                else { play(); }
            }

            return { state, play, pause, resume, stop };
        };

        const AudioControl = ({ text }) => {
            const { state, play, pause, resume, stop } = useAudioPlayer(text);
            
            return (
                <div className="flex items-center gap-2 mb-3">
                    <button onClick={state === 'playing' ? pause : (state === 'paused' ? resume : play)} 
                        className={`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-bold transition-all ${state === 'playing' ? 'bg-blue-100 text-blue-600 ring-2 ring-blue-200' : 'bg-white border border-gray-200 text-gray-600 hover:bg-gray-50'}`}>
                        {state === 'playing' ? <Icons.Pause /> : <Icons.Play />}
                        {state === 'playing' ? 'æš«åœæœ—è®€' : (state === 'paused' ? 'ç¹¼çºŒæœ—è®€' : 'å…¨æ–‡æœ—è®€')}
                    </button>
                    {(state === 'playing' || state === 'paused') && (
                         <button onClick={stop} className="p-2 text-gray-400 hover:text-red-500 bg-white border border-gray-200 rounded-full">
                            <Icons.Square />
                         </button>
                    )}
                </div>
            )
        };

        const BottomSheet = ({ data, type, onClose, isQuizMode }) => {
            const { state, play, pause, resume, stop } = useAudioPlayer(type === 'vocab' ? `${data.word}. ${data.ex}` : '');
            const [isRevealed, setIsRevealed] = useState(false);

            useEffect(() => { setIsRevealed(false); return () => stop(); }, [data.id || data.word]);
            const showHidden = isQuizMode && type === 'vocab' && !isRevealed;

            return (
                <div className="fixed inset-0 z-50 flex items-end justify-center pointer-events-none">
                    <div className="absolute inset-0 bg-black/40 animate-fade-in pointer-events-auto" onClick={onClose}></div>
                    <div className="bg-white w-full rounded-t-2xl p-6 pb-12 shadow-[0_-5px_20px_rgba(0,0,0,0.15)] animate-slide-up pointer-events-auto relative max-h-[80vh] overflow-y-auto">
                        <div className="w-12 h-1.5 bg-gray-200 rounded-full mx-auto mb-6"></div>
                        <button onClick={onClose} className="absolute top-4 right-4 text-gray-400 p-2"><Icons.X /></button>

                        <div className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2">
                            {type === 'vocab' ? 'Vocabulary' : 'Formula Examples'}
                        </div>

                        {type === 'footnote' && (
                            <div className="space-y-3">
                                {data.map((ex, i) => (
                                    <div key={i} className="p-3 bg-blue-50 rounded-lg text-base text-gray-800 border-l-4 border-blue-400">
                                        {ex}
                                    </div>
                                ))}
                            </div>
                        )}

                        {type === 'vocab' && showHidden && (
                            <div className="text-center py-6">
                                <div className="text-gray-500 mb-2">{data.pos}</div>
                                <div className="font-bold text-xl mb-6">{data.def}</div>
                                <button onClick={() => setIsRevealed(true)}
                                    className="flex items-center justify-center gap-2 w-full py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-bold shadow-lg shadow-blue-200 active:scale-95 transition-transform">
                                    <Icons.Eye /> æ­æ›‰ç­”æ¡ˆ
                                </button>
                            </div>
                        )}

                        {type === 'vocab' && !showHidden && (
                            <div>
                                <div className="flex justify-between items-end mb-2">
                                    <h3 className="text-3xl font-bold text-gray-900 leading-none">{data.word}</h3>
                                    <span className="font-mono text-gray-500">{data.kk}</span>
                                </div>
                                <div className="flex items-center gap-2 mb-6">
                                    <span className="text-xs font-bold bg-gray-100 px-2 py-1 rounded text-gray-600">{data.pos}</span>
                                    <span className="text-lg text-gray-800 font-medium">{data.def}</span>
                                </div>
                                <div className="flex items-center gap-3 mb-6 bg-gray-50 p-2 pr-4 rounded-full w-max border border-gray-100">
                                    <button onClick={state === 'playing' ? pause : (state === 'paused' ? resume : play)} 
                                        className="w-10 h-10 flex items-center justify-center bg-white shadow rounded-full text-blue-600 active:bg-gray-50">
                                        {state === 'playing' ? <Icons.Pause /> : <Icons.Play />}
                                    </button>
                                    <button onClick={stop} className="p-2 text-gray-400 hover:text-red-500"><Icons.Square /></button>
                                    <div className="h-4 w-[1px] bg-gray-300 mx-1"></div>
                                    <span className="text-xs font-medium text-blue-900">
                                        {state === 'playing' ? 'Playing...' : 'Listen'}
                                    </span>
                                </div>
                                <div className="text-base text-gray-600 italic border-l-2 border-gray-300 pl-3 leading-relaxed">
                                    "{data.ex}"
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const TextParser = ({ text, onActivate, activeId, isQuizMode }) => {
            const parts = text.split(/(\[\d+\]|[\u4e00-\u9fa5]+[a-zA-Z0-9\(\)\/]*|[\s\.,;!?()]+)/g).filter(Boolean);

            return (
                <p className="leading-relaxed text-[17px] text-gray-800 font-normal tracking-wide">
                    {parts.map((part, index) => {
                        // Footnote
                        if (/^\[\d+\]$/.test(part)) {
                            const id = parseInt(part.replace(/[\[\]]/g, ''));
                            return (
                                <button key={index} 
                                    onClick={(e) => { e.stopPropagation(); onActivate('footnote', id); }}
                                    className="inline-flex items-center justify-center min-w-[18px] h-[18px] ml-1 align-top text-[10px] font-bold bg-[#EB5757]/10 text-[#EB5757] rounded active:bg-[#EB5757] active:text-white transition-colors">
                                    {id}
                                </button>
                            );
                        }
                        // Chinese Placeholder
                        if (/[\u4e00-\u9fa5]/.test(part)) {
                            return <span key={index} className="text-gray-400 mx-1 border-b border-dashed border-gray-300">{part}</span>;
                        }
                        // Vocab Check
                        const lower = part.toLowerCase();
                        if (VOCAB_DB[lower]) {
                            const isActive = activeId === `vocab-${lower}`;
                            if (isQuizMode) {
                                return (
                                    <span key={index} onClick={(e) => { e.stopPropagation(); onActivate('vocab', lower); }}
                                        className="border-b-2 border-[#EB5757] bg-[#EB5757]/5 px-1 mx-0.5 text-transparent active:bg-[#EB5757]/20 transition-colors cursor-pointer">
                                        {part}
                                    </span>
                                );
                            }
                            return (
                                <span key={index} onClick={(e) => { e.stopPropagation(); onActivate('vocab', lower); }}
                                    className={`px-1 mx-0.5 rounded transition-colors cursor-pointer ${isActive ? 'bg-blue-200 text-blue-900' : 'bg-[#E3E2E0] active:bg-blue-100'}`}>
                                    {part}
                                </span>
                            );
                        }
                        return <span key={index}>{part}</span>;
                    })}
                </p>
            );
        };

        const EssayCard = ({ essay, onActivate, activePopoverKey, isQuizMode }) => {
            const [showTrans, setShowTrans] = useState(false);

            return (
                <div>
                    <h2 className="text-xl font-bold mb-2 text-gray-900 leading-tight">
                        {essay.title}
                    </h2>
                    
                    <div className="bg-gray-100 p-3 rounded-lg mb-4 text-sm text-gray-600 leading-relaxed border-l-4 border-gray-300">
                        {essay.prompt}
                    </div>

                    <AudioControl text={essay.content} />
                    
                    <div className="mb-4">
                        <TextParser text={essay.content} onActivate={onActivate} activeId={activePopoverKey} isQuizMode={isQuizMode} />
                    </div>

                    <button 
                        onClick={() => setShowTrans(!showTrans)}
                        className="flex items-center gap-1.5 text-xs font-bold text-gray-500 bg-gray-100 hover:bg-gray-200 px-3 py-2 rounded-full transition-colors mb-4">
                        <Icons.Translate />
                        {showTrans ? 'éš±è—ä¸­æ–‡ç¿»è­¯' : 'æŸ¥çœ‹ä¸­æ–‡ç¿»è­¯'}
                        {showTrans ? <Icons.ChevronUp /> : <Icons.ChevronDown />}
                    </button>

                    {showTrans && (
                        <div className="bg-[#F3F4F6] p-4 rounded-xl text-[15px] leading-relaxed text-gray-700 animate-fade-in border border-gray-200">
                            {essay.translation.split('\n\n').map((p, i) => (
                                <p key={i} className={i > 0 ? 'mt-4' : ''}>{p}</p>
                            ))}
                        </div>
                    )}
                    
                    <div className="h-px bg-gray-100 my-8"></div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('formula');
            const [activePopover, setActivePopover] = useState(null); 
            const [isQuizMode, setIsQuizMode] = useState(false);

            const handleActivate = (type, id) => setActivePopover({ type, id, key: `${type}-${id}` });
            const closePopover = () => setActivePopover(null);

            return (
                <div className="flex flex-col h-full bg-white relative">
                    
                    {/* Header */}
                    <div className="bg-white/90 backdrop-blur border-b border-gray-200 px-4 py-3 flex justify-between items-center z-20 shrink-0 safe-top gap-3">
                        <div className="font-bold text-base text-gray-800 truncate flex-1">
                            è¬ç”¨ä½œæ–‡æ¨¡æ¿ï¼šè«–è¿°èˆ‡å€‹äººæ„è¦‹ç‰ˆ
                        </div>
                        
                        <div className="flex items-center gap-2 bg-gray-100 rounded-full pl-3 pr-2 py-1 cursor-pointer shrink-0" onClick={() => setIsQuizMode(!isQuizMode)}>
                            <span className={`text-[10px] font-bold tracking-wider ${!isQuizMode ? 'text-blue-600' : 'text-gray-400'}`}>
                                STUDY
                            </span>
                            <div className="transition-colors text-gray-400">
                                {isQuizMode ? <Icons.ToggleRight /> : <Icons.ToggleLeft />}
                            </div>
                            <span className={`text-[10px] font-bold tracking-wider ${isQuizMode ? 'text-[#EB5757]' : 'text-gray-400'}`}>
                                QUIZ
                            </span>
                        </div>
                    </div>

                    {/* Content */}
                    <div className="flex-1 overflow-y-auto overflow-x-hidden pb-24 px-5 pt-6 hide-scrollbar bg-white">
                        {activeTab === 'formula' && (
                            <div className="animate-fade-in">
                                <div className="mb-8 bg-blue-50/80 p-4 rounded-xl border border-blue-100">
                                    <div className="text-xs font-bold text-blue-400 uppercase tracking-widest mb-2">Instructions</div>
                                    <div className="space-y-2 text-sm text-blue-900">
                                        <p><span className="font-bold">Step 1:</span> é–±è®€æ¨£æ¿ (ä¸ç”¨èƒŒæ¨£æ¿)</p>
                                        <p><span className="font-bold">Step 2:</span> é–±è®€ç¯„æ–‡</p>
                                        <div>
                                            <span className="font-bold">Step 3:</span> <span className="underline decoration-blue-300">å…¨æ–‡èƒŒèª¦</span>ä¸€ç¯‡ç¯„æ–‡
                                            <div className="mt-1 text-xs text-blue-600 font-medium bg-blue-100/50 p-2 rounded">
                                                â­ ç¯„æ–‡æœ‰ä¸Šä¸‹æ–‡ï¼Œæ¯”å…¬å¼å¥½èƒŒï¼ŒèƒŒç†Ÿå¾Œè‡ªç„¶èƒ½éˆæ´»é‹ç”¨ã€‚
                                            </div>
                                        </div>
                                    </div>

                                    {/* --- é©ç”¨é¡Œå‹å€å¡Š (æ›´æ–°) --- */}
                                    <div className="mt-4 pt-4 border-t border-blue-200/60">
                                        <div className="font-bold text-blue-900 mb-2">é©ç”¨é¡Œå‹ï¼š</div>
                                        <ul className="list-disc pl-4 space-y-1 text-sm text-blue-800 mb-3">
                                            <li>
                                                <span className="font-bold text-blue-600">(ç„¡åœ–)</span> å¹¾ä¹éƒ½é©ç”¨ï¼Œå°¤å…¶æ˜¯è¨è«–æŸè­°é¡Œæˆ–ç†±é–€è©±é¡Œä¹‹é¡çš„é¡Œç›®
                                            </li>
                                            <li>
                                                <span className="font-bold text-blue-600">(æœ‰åœ–)</span> å–®å¼µåœ–ç‰‡é¡Œã€é›™åœ–ä½†å…©å¼µåœ–ä¸æ˜¯äº’ç‚ºå°æ¯”ã€å¤šåœ–ä½†èˆ‡å€‹äººæ„è¦‹æˆ–è­°é¡Œè¨è«–æœ‰é—œ(ä¾‹å¦‚112å­¸æ¸¬è¡¨æƒ…ç¬¦è™Ÿï¼Œ113å­¸æ¸¬æ©Ÿå™¨äººå°å¹«æ‰‹ç­‰)
                                            </li>
                                        </ul>
                                        
                                        {/* ç¨ç«‹é€£çµ */}
                                        <div className="space-y-2 mt-3">
                                            <a href="https://docs.google.com/document/d/1hOnWGYO5OgpI3VuUFc8FasQ20xbNWws5Q5jr6seQQXU/edit?usp=sharing" 
                                               target="_blank" 
                                               rel="noreferrer"
                                               className="flex items-center gap-1 text-sm font-bold text-blue-600 hover:text-blue-800 transition-colors group w-max">
                                                <span>ğŸ‘‰</span>
                                                <span className="border-b border-blue-600 border-dashed group-hover:border-solid">çœ‹æ‰€æœ‰é©ç”¨é¡Œç›®èˆ‡ç¯„æ–‡</span>
                                            </a>
                                            <a href="https://gemini.google.com/gem/15OLe1972r3eqbkbPbcM3opveq2uw3PKJ?usp=sharing" 
                                               target="_blank" 
                                               rel="noreferrer"
                                               className="flex items-center gap-1 text-sm font-bold text-blue-600 hover:text-blue-800 transition-colors group w-max">
                                                <span>ğŸ‘‰</span>
                                                <span className="border-b border-blue-600 border-dashed group-hover:border-solid">ä¸Šå‚³é¡Œç›®å¹«ä½ å¯«åƒè€ƒç¯„æ–‡</span>
                                            </a>
                                        </div>
                                    </div>
                                    {/* --- é©ç”¨é¡Œå‹å€å¡ŠçµæŸ --- */}

                                </div>

                                <h2 className="text-2xl font-bold mb-6 text-gray-900">è¬ç”¨ä½œæ–‡æ¨¡ç‰ˆ</h2>
                                {FORMULA_PARAGRAPHS.map((para, i) => (
                                    <div key={i}>
                                        <AudioControl text={para} />
                                        <TextParser text={para} onActivate={handleActivate} activeId={activePopover?.key} isQuizMode={isQuizMode} />
                                        {i < FORMULA_PARAGRAPHS.length - 1 && <div className="h-6"></div>}
                                    </div>
                                ))}
                            </div>
                        )}

                        {activeTab === 'essays' && (
                            <div className="animate-fade-in space-y-12">
                                {ESSAYS_DATA.map(essay => (
                                    <EssayCard 
                                        key={essay.id} 
                                        essay={essay} 
                                        onActivate={handleActivate} 
                                        activePopoverKey={activePopover?.key} 
                                        isQuizMode={isQuizMode} 
                                    />
                                ))}
                            </div>
                        )}
                    </div>

                    {/* Nav */}
                    <nav className="shrink-0 bg-white border-t border-gray-200 safe-bottom pb-safe z-30">
                        <div className="flex justify-around items-center h-16">
                            <button onClick={() => setActiveTab('formula')} 
                                className={`flex flex-col items-center justify-center w-full h-full space-y-1 ${activeTab === 'formula' ? 'text-blue-600' : 'text-gray-400'}`}>
                                <Icons.Book />
                                <span className="text-[10px] font-medium">æ¨£æ¿</span>
                            </button>
                            <button onClick={() => setActiveTab('essays')} 
                                className={`flex flex-col items-center justify-center w-full h-full space-y-1 ${activeTab === 'essays' ? 'text-blue-600' : 'text-gray-400'}`}>
                                <Icons.FileText />
                                <span className="text-[10px] font-medium">ç¯„æ–‡</span>
                            </button>
                        </div>
                    </nav>

                    {/* Popover */}
                    {activePopover && (
                        <BottomSheet 
                            data={activePopover.type === 'vocab' 
                                ? { ...VOCAB_DB[activePopover.id], word: activePopover.id } 
                                : FOOTNOTE_DB[activePopover.id]} 
                            type={activePopover.type} 
                            onClose={closePopover} 
                            isQuizMode={isQuizMode} 
                        />
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
